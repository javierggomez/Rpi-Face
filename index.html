<!DOCTYPE html>
<html>
<head>
    <meta charset='iso-8859-15' />
    <title>Rpi-face</title>
    <link rel='STYLESHEET' type='text/css' href='/style/style.css'></link> 

    <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
    
     <script type="text/javascript">
$(document).ready(function() {
	var recognition=null;
	if (!('webkitSpeechRecognition' in window)) {
		$('#record>img').attr('title', 'La función de reconocimiento de voz solo es soportada por Chrome 25 o superior.');
	} else {
		$('#message').attr('placeholder', 'Escribe un mensaje o pincha en el micrófono y habla');
 		recognition = new webkitSpeechRecognition();
 		recognition.lang='es-ES';
		//recognition.onstart = function() {
		//}
  		recognition.onresult = function(event) {
  			var message='';
  			for (var i=event.resultIndex;i<event.results.length;i++) {
  				message+=event.results[i][0].transcript;
  			}
  			$('#message').val(message);
  		};
  		recognition.onerror = function(event) { 
  			alert('Error: '+event.error);
  		 };
  		//recognition.onend = function() { 
  		//}
  	}
  	$('#record').on('click', function() {
  		if (recognition==null) {
  			alert('La función de reconocimiento de voz solo es soportada por Chrome 25 o superior.');
  			return;
  		}
  		$('#message').val('');
  		$('#message').attr('placeholder', 'Habla ahora');
  		recognition.start();
  	});
});
     </script>
</head>
<body>
	<div class='center'>
		<h1>Bienvenido a Rpi-face</h1>
		<div class='text'>
			Bienvenido a Rpi-face.
			Desde aquí podrás interactuar con el sistema.
			Por un lado dispones de la sección enviar mensajes, desde la cual le podrás enviar un mensaje al robot.
			Por otro lado podrás moverle la cara a la posición deseada.
		</div>
		<h1>Enviar mensaje</h1>
		<div id='form'>
			<span class='text'>Texto a enviar: </span>
			<form id='in_form' action='/cgi-bin/server_query.cgi' method='GET'>
				<textarea id='message' name='message' rows=3 placeholder="Escribe un mensaje"><%r1%></textarea><br/>
				<input class='input' type='submit' value='Enviar'/>
			</form>
			<button id="record" onclick="speech_recognition">
				<img alt="Grabar" src="/img/img_microphone.ico"/>
			</button>
			<p class="clear"/>
		</div>
		<h1>Mover cara</h1>
		<div id="actions">
			<ul class='menu'>
				<li><a href='/cgi-bin/server_query.cgi?face=0' >Cara contenta</a></li>
				<li><a href='/cgi-bin/server_query.cgi?face=1' >Cara triste</a></li>
				<li><a href='/cgi-bin/server_query.cgi?face=2' >Cara sorprendida</a></li>
				<li><a href='/cgi-bin/server_query.cgi?face=3' >Cara enfadada</a></li>
				<li><a href='/cgi-bin/server_query.cgi?face=4' >Cara neutral</a></li>
			</ul>
		</div>
		<p class="center"><%r2%></p>
	</div>
</body>
</html>